[{"path":"https://okezie94.github.io/mrbayes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Okezie Uche-Ikonne. Author. Frank Dondelinger. Author. Tom Palmer. Author, maintainer.","code":""},{"path":"https://okezie94.github.io/mrbayes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Uche-Ikonne O, Dondelinger F, Palmer T (2021). “Software Application Profile: Bayesian estimation inverse variance weighted MR-Egger models two-sample Mendelian randomization studies – mrbayes.” International Journal Epidemiology, 50(1), 43–49. doi:10.1093/ije/dyaa191.","code":"@Article{mrbayes,   author = {Okezie Uche-Ikonne and Frank Dondelinger and Tom Palmer},   title = {{Software Application Profile: Bayesian estimation of inverse variance weighted and MR-Egger models for two-sample Mendelian randomization studies -- mrbayes}},   journal = {International Journal of Epidemiology},   volume = {50},   number = {1},   pages = {43--49},   year = {2021},   doi = {10.1093/ije/dyaa191}, }"},{"path":"https://okezie94.github.io/mrbayes/index.html","id":"mrbayes","dir":"","previous_headings":"","what":"Bayesian Summary Data Models for Mendelian Randomization Studies","title":"Bayesian Summary Data Models for Mendelian Randomization Studies","text":"Bayesian implementation IVW MR-Egger models.","code":""},{"path":"https://okezie94.github.io/mrbayes/index.html","id":"installation-instructions","dir":"","previous_headings":"","what":"Installation instructions","title":"Bayesian Summary Data Models for Mendelian Randomization Studies","text":"Install CRAN version following code: install development version r-universe GitHub :","code":"install.packages(\"mrbayes\") install.packages(\"mrbayes\", repos = c(\"https://mrcieu.r-universe.dev\", \"https://cloud.r-project.org\")) # install.packages(\"remotes\") # uncomment if remotes not installed remotes::install_github(\"okezie94/mrbayes\")"},{"path":"https://okezie94.github.io/mrbayes/index.html","id":"installing-jags-to-use-the-jags-functions","dir":"","previous_headings":"Installation instructions","what":"Installing JAGS to use the JAGs functions","title":"Bayesian Summary Data Models for Mendelian Randomization Studies","text":"Using functions use JAGS require JAGS software installed. macOS easiest way install JAGS Homebrew Alternatively, JAGS installation files Windows macOS available https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/, info can found JAGS website https://mcmc-jags.sourceforge.io/. R can install rjags source","code":"brew install pkg-config brew install jags install.packages(\"rjags\", type = \"source\")"},{"path":"https://okezie94.github.io/mrbayes/index.html","id":"package-website","dir":"","previous_headings":"","what":"Package website","title":"Bayesian Summary Data Models for Mendelian Randomization Studies","text":"helpfiles shown package website : https://okezie94.github.io/mrbayes/.","code":""},{"path":"https://okezie94.github.io/mrbayes/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Bayesian Summary Data Models for Mendelian Randomization Studies","text":"Okezie Uche-Ikonne, Frank Dondelinger, Tom Palmer","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/bmi_insulin.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset from Richmond et. al 2017 investigating the association of BMI on insulin resistance — bmi_insulin","title":"Dataset from Richmond et. al 2017 investigating the association of BMI on insulin resistance — bmi_insulin","text":"two-sample summary level dataset, Richmond et al. (2017) doi:10.1101/155739 , containing 14 single nucleiodtide polymorphisms (SNPs) genotype-phenotype associations (BMI) genotype-outcome associations (insulin) respective standard errors.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/bmi_insulin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset from Richmond et. al 2017 investigating the association of BMI on insulin resistance — bmi_insulin","text":"","code":"bmi_insulin"},{"path":"https://okezie94.github.io/mrbayes/reference/bmi_insulin.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset from Richmond et. al 2017 investigating the association of BMI on insulin resistance — bmi_insulin","text":"data frame 14 rows 44 columns: rsid SNP RSID number beta.exposure genotype-BMI associations beta.outcome genotype-outcome associations se.exposure standard errors genotype-phenotype associations se.outcome standard errors genotype-outcome associations","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/bmi_insulin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dataset from Richmond et. al 2017 investigating the association of BMI on insulin resistance — bmi_insulin","text":"bmi_insulin.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/bmi_insulin.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dataset from Richmond et. al 2017 investigating the association of BMI on insulin resistance — bmi_insulin","text":"Richmond, R. et al., Investigating role insulin increased adiposity: Bi-directional Mendelian randomization study. bioRxiv, 2017, doi:10.1101/155739 .","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/dodata.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset from Do et al., Nat Gen, 2013 containing summary level data on associations of genotypes with lipid traits and the risk of coronary heart diseases — dodata","title":"Dataset from Do et al., Nat Gen, 2013 containing summary level data on associations of genotypes with lipid traits and the risk of coronary heart diseases — dodata","text":"summary-level dataset, et al. (2013) doi:10.1038/ng.2795 , containing 185 single nucleodtide polymorphisms (SNPs) genotype-phenotype associations standard errors LDL-C, HDL-C, Triglycerides, genotype-outcome associations coronary heart disease respective standard errors.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/dodata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset from Do et al., Nat Gen, 2013 containing summary level data on associations of genotypes with lipid traits and the risk of coronary heart diseases — dodata","text":"","code":"dodata"},{"path":"https://okezie94.github.io/mrbayes/reference/dodata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset from Do et al., Nat Gen, 2013 containing summary level data on associations of genotypes with lipid traits and the risk of coronary heart diseases — dodata","text":"data frame 185 rows 21 columns following variables: rsid RSID number a1 Allele 1 a2 Allele 2 chr Chromosome pos Genomic position ldlcbeta genotype-low-density lipoprotein cholestrol associations hdlcbeta genotype-high-density lipoprotein cholestrol associations tgbeta genotype-triglyceride associations chdbeta genotype-coronary heart disease associations, log odds ratio scale ldlcp2 P-value genotype-LDL-C associations hdlcp2 P-value genotype-HDL-C associations tgp2 P-value genotype-triglyceride associations chdp2 P-value genotype-coronary heart disease associations ldlcz Z-score genotype-LDL-C associations ldlcse standard errors genotype-low-density lipoprotein cholestrol associations hdlcz Z-score genotype-HDL-C associations hdlcse standard errors genotype-high-density lipoprotein cholestrol associations tgz Z-score genotype-triglyceride associations tgse standard errors genotype-triglyceride cholestrol associations chdz Z-score genotype-coronary heart disease associations chdse standard errors genotype-coronary heart disease associations","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/dodata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dataset from Do et al., Nat Gen, 2013 containing summary level data on associations of genotypes with lipid traits and the risk of coronary heart diseases — dodata","text":"dodata.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/dodata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dataset from Do et al., Nat Gen, 2013 containing summary level data on associations of genotypes with lipid traits and the risk of coronary heart diseases — dodata","text":", R. et al., Common variants associated plasma triglycerides risk coronary artery disease. Nature Genetics, 2013, 45, 1345-1352, doi:10.1038/ng.2795 .","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_rjags.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","title":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","text":"Bayesian implementation MR-Egger multivariate model choice prior distributions fitted using JAGS.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_rjags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","text":"","code":"mr_egger_rjags(   object,   prior = \"default\",   betaprior = \"\",   sigmaprior = \"\",   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = NULL,   rho = 0.5,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_rjags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","text":"object data object class mr_format. prior character string selecting prior distributions; \"default\" selects non-informative set priors; \"weak\" selects weakly informative priors; \"pseudo\" selects pseudo-horseshoe prior causal effect; \"joint\" selects joint prior intercept slope. betaprior character string JAGS syntax allow user defined prior causal effect. sigmaprior character string JAGS syntax allow user defined prior residual standard deviation. n.chains Numeric indicating number chains used MCMC estimation, default 3 chains. n.burn Numeric indicating burn-period Bayesian MCMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default rjags default. rho Numeric indicating correlation coefficient input joint prior distribution. default value 0.5. ... Additional arguments passed rjags::jags.model().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_rjags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","text":"object class eggerjags containing following components: AvgPleio mean simulated pleiotropic effect CausalEffect mean simulated causal effect StandardError Standard deviation simulated causal effect sigma value residual standard deviation CredibleInterval credible interval causal effect, includes lower (2.5%), median (50%) upper intervals (97.5%) samples Output Bayesian MCMC samples Priors specified priors","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_rjags.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","text":"Bowden et. al., Mendelian randomization invalid instruments: effect estimation bias detection Egger regression. International Journal Epidemiology 2015. 44(2): p. 512-525. doi:10.1093/ije/dyv080","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_rjags.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian implementation of the MR-Egger multivariate model with choice of prior distributions fitted using JAGS. — mr_egger_rjags","text":"","code":"if (requireNamespace(\"rjags\", quietly = TRUE)) { fit <- mr_egger_rjags(bmi_insulin) summary(fit) plot(fit$samples) # 90% credible interval fitdf <- do.call(rbind.data.frame, fit$samples) cri90 <- sapply(fitdf, quantile, probs = c(0.05, 0.95)) print(cri90) } #> Prior :  #>  #>  Pleiotropy ~ dnorm(0, 1E-3)  #>  Estimate ~ dnorm(0, 1E-3)  #>  sigma ~ dunif(.0001, 10)  #>  #> Estimation results:  #>   #>  MCMC iterations = 6000  #>  Burn in = 1000  #>  Sample size by chain = 5000  #>  Number of Chains = 3  #>  Number of SNPs = 14  #>   #> Inflating Parameter: 7.63072  #>  #>                  Estimate         SD       2.5%         50%      97.5% #> Avg Pleio     -0.05423754 0.03587126 -0.1249326 -0.05289878 0.01408735 #> Causal Effect  3.74906123 2.12741936 -0.2994558  3.67181831 7.95763439  #>      Estimate   Pleiotropy    sigma #> 5%  0.3637214 -0.114480488 5.686757 #> 95% 7.3196728  0.003112578 9.600718"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_stan.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","text":"Bayesian inverse variance weighted model choice prior distributions fitted using Stan.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_stan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","text":"","code":"mr_egger_stan(   data,   prior = 1,   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = 12345,   rho = 0.5,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_stan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","text":"data data class mr_format. prior integer selecting prior distributions; 1 selects non-informative set priors; 2 selects weakly informative priors; 3 selects pseudo-horseshoe prior causal effect; 4 selects joint prior intercept causal effect estimate. n.chains Numeric indicating number chains used HMC estimation rstan, default 3 chains. n.burn Numeric indicating burn-period Bayesian HMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian HMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default 12345. rho Numeric indicating correlation coefficient input joint prior distribution. default 0.5. ... Additional arguments passed rstan::sampling().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_stan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","text":"object class rstan::stanfit.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_stan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","text":"Bowden J, Davey Smith G, Burgess S. Mendelian randomization invalid instruments: effect estimation bias detection Egger regression. International Journal Epidemiology, 2015, 44, 2, 512-525. doi:10.1093/ije/dyv080 . Stan Development Team (2020). \"RStan: R interface Stan.\" R package version 2.19.3, https://mc-stan.org/.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_egger_stan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using Stan — mr_egger_stan","text":"","code":"if (requireNamespace(\"rstan\", quietly = TRUE)) { # Note we recommend setting n.burn and n.iter to larger values suppressWarnings(egger_fit <- mr_egger_stan(bmi_insulin, n.burn = 500, n.iter = 1000, refresh = 0L)) print(egger_fit) } #> Inference for Stan model: mregger. #> 3 chains, each with iter=1000; warmup=500; thin=1;  #> post-warmup draws per chain=500, total post-warmup draws=1500. #>  #>             mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat #> intercept  -0.06    0.00 0.04  -0.15  -0.08  -0.06  -0.04   0.01   195 1.01 #> estimate    4.12    0.16 2.35  -0.16   2.54   3.89   5.53   9.69   210 1.01 #> sigma       7.74    0.08 1.18   5.57   6.84   7.75   8.64   9.80   218 1.02 #> lp__      -35.48    0.08 1.18 -38.47 -35.98 -35.18 -34.63 -34.10   197 1.03 #>  #> Samples were drawn using NUTS(diag_e) at Mon Aug 19 14:09:19 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://okezie94.github.io/mrbayes/reference/mr_format.html","id":null,"dir":"Reference","previous_headings":"","what":"Organises the summary level data for use in the Bayesian MR functions — mr_format","title":"Organises the summary level data for use in the Bayesian MR functions — mr_format","text":"Organises summary level data use Bayesian MR functions","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_format.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Organises the summary level data for use in the Bayesian MR functions — mr_format","text":"","code":"mr_format(rsid, xbeta, ybeta, xse, yse)"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_format.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Organises the summary level data for use in the Bayesian MR functions — mr_format","text":"rsid vector genetic variants used analysis, unspecified vector automatically generated. xbeta numeric vector instrument-phenotype associations. ybeta numeric vector instrument-outcome associations. xse standard errors instrument-phenotype associations xbeta. yse standard errors instrument-outcome associations ybeta.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_format.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Organises the summary level data for use in the Bayesian MR functions — mr_format","text":"formatted data frame analysis class mr_format.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_format.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Organises the summary level data for use in the Bayesian MR functions — mr_format","text":"","code":"data(bmi_insulin) dat <- mr_format(   rsid = bmi_insulin[,\"rsid\"],   xbeta = bmi_insulin[,\"beta.exposure\"],   ybeta = bmi_insulin[,\"beta.outcome\"],   xse = bmi_insulin[,\"se.exposure\"],   yse = bmi_insulin[,\"se.outcome\"] ) class(dat) #> [1] \"data.frame\" \"mr_format\""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_rjags.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","text":"Bayesian inverse variance weighted model choice prior distributions fitted using JAGS.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_rjags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","text":"","code":"mr_ivw_rjags(   object,   prior = \"default\",   betaprior = \"\",   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = NULL,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_rjags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","text":"object data object class mr_format. prior character string selecting prior distributions; \"default\" selects non-informative set priors; \"weak\" selects weakly informative priors; \"pseudo\" selects pseudo-horseshoe prior causal effect. betaprior character string JAGS syntax allow user defined prior causal effect. n.chains Numeric indicating number chains used MCMC estimation, default 3 chains. n.burn Numeric indicating burn-period Bayesian MCMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default rjags default. ... Additional arguments passed rjags::jags.model().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_rjags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","text":"object class ivwjags containing following components: CausalEffect mean simulated causal effects StandardError Standard deviation simulated causal effects CredibleInterval credible interval causal effect, indicates lower (2.5%), median (50%) upper intervals (97.5%) samples Output Bayesian MCMC samples different chains Priors specified priors","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_rjags.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","text":"Burgess, S., Butterworth, ., Thompson S.G. Mendelian randomization analysis multiple genetic variants using summarized data. Genetic Epidemiology, 2013, 37, 7, 658-665 doi:10.1002/gepi.21758 .","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_rjags.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mr_ivw_rjags","text":"","code":"if (requireNamespace(\"rjags\", quietly = TRUE)) { fit <- mr_ivw_rjags(bmi_insulin) print(fit) summary(fit) plot(fit$samples) # 90% credible interval fitdf <- do.call(rbind.data.frame, fit$samples) cri90 <- quantile(fitdf$Estimate, probs = c(0.05, 0.95)) print(cri90) } #>                Estimate         SD      2.5%       50%     97.5% #> Causal Effect 0.5794726 0.05051618 0.4797503 0.5797655 0.6784202 #> Prior :  #>  #>  Estimate ~ dnorm(0, 1E-3)  #>  #> Estimation results:  #>   #>  MCMC iterations = 6000  #>  Burn in = 1000  #>  Sample size by chain = 5000  #>  Number of Chains = 3  #>  Number of SNPs = 14  #>   #>                Estimate         SD      2.5%       50%     97.5% #> Causal Effect 0.5794726 0.05051618 0.4797503 0.5797655 0.6784202  #>        5%       95%  #> 0.4954094 0.6625735"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_stan.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","text":"Bayesian inverse variance weighted model choice prior distributions fitted using RStan.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_stan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","text":"","code":"mr_ivw_stan(   data,   prior = 1,   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = 12345,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_stan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","text":"data data class mr_format. prior integer selecting prior distributions; 1 selects non-informative set priors; 2 selects weakly informative priors; 3 selects pseudo-horseshoe prior causal effect. n.chains Numeric indicating number chains used HMC estimation rstan, default 3 chains. n.burn Numeric indicating burn-period Bayesian HMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default 12345. ... Additional arguments passed rstan::sampling().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_stan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","text":"object class rstan::stanfit.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_stan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","text":"Burgess, S., Butterworth, ., Thompson S.G. Mendelian randomization analysis multiple genetic variants using summarized data. Genetic Epidemiology, 2013, 37, 7, 658-665 doi:10.1002/gepi.21758 . Stan Development Team (2020). \"RStan: R interface Stan.\" R package version 2.19.3, https://mc-stan.org/.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_ivw_stan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_ivw_stan","text":"","code":"if (requireNamespace(\"rstan\", quietly = TRUE)) { suppressWarnings(ivw_fit <- mr_ivw_stan(bmi_insulin, refresh = 0L)) print(ivw_fit) rstan::traceplot(ivw_fit) } #> Inference for Stan model: mrivw. #> 3 chains, each with iter=5000; warmup=1000; thin=1;  #> post-warmup draws per chain=4000, total post-warmup draws=12000. #>  #>             mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff #> estimate    0.58    0.00 0.05    0.48    0.54    0.58    0.61    0.68  2739 #> lp__     -393.05    0.02 0.73 -395.07 -393.22 -392.77 -392.58 -392.53  2318 #>          Rhat #> estimate    1 #> lp__        1 #>  #> Samples were drawn using NUTS(diag_e) at Mon Aug 19 14:09:21 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_rjags.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","title":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","text":"Bayesian radial MR-Egger model choice prior distributions fitted using JAGS.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_rjags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","text":"","code":"mr_radialegger_rjags(   object,   prior = \"default\",   betaprior = \"\",   sigmaprior = \"\",   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = NULL,   rho = 0.5,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_rjags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","text":"object data object class mr_format. prior character string selecting prior distributions; \"default\" selects non-informative set priors; \"weak\" selects weakly informative priors; \"pseudo\" selects pseudo-horseshoe prior causal effect; \"joint\" selects joint prior intercept slope. betaprior character string JAGS syntax allow user defined prior causal effect. sigmaprior character string JAGS syntax allow user defined prior residual standard deviation. n.chains Numeric indicating number chains used MCMC estimation, default 3 chains. n.burn Numeric indicating burn-period Bayesian MCMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default rjags default. rho Numeric indicating correlation coefficient input joint prior distribution. default 0.5. ... Additional arguments passed rjags::jags.model().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_rjags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","text":"object class radialeggerjags containing following components: AvgPleio mean simulated pleiotropic effect CausalEffect mean simulated causal effect StandardError Standard deviation simulated causal effect sigma mean simaulted residual standard deviation CredibleInterval credible interval causal effect, includes lower (2.5%), median (50%) upper intervals (97.5%) samples Output Bayesian MCMC samples Prior specified priors","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_rjags.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","text":"Bowden, J., et al., Improving visualization, interpretation analysis two-sample summary data Mendelian randomization via Radial plot Radial regression. International Journal Epidemiology, 2018. 47(4): p. 1264-1278. doi:10.1093/ije/dyy101 .","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_rjags.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian radial MR-Egger model with a choice of prior distributions fitted using JAGS. — mr_radialegger_rjags","text":"","code":"if (requireNamespace(\"rjags\", quietly = TRUE)) { fit <- mr_radialegger_rjags(bmi_insulin) summary(fit) plot(fit$samples) # 90% credible interval fitdf <- do.call(rbind.data.frame, fit$samples) cri90 <- quantile(fitdf$Estimate, probs = c(0.05, 0.95)) print(cri90) } #> Warning: The mean of the sigma parameter, the residual standard deviation, is less than 1, we recommend refitting the model with sigma constrained to be >= 1. #> Prior :  #>  #>  Pleiotropy ~ dnorm(0, 1E-3)  #>  Estimate ~ dnorm(0, 1E-3)  #>  sigma ~ dunif(.0001, 10)  #>  #> Estimation results:  #>   #>  MCMC iterations = 6000  #>  Burn in = 1000  #>  Sample size by chain = 5000  #>  Number of Chains = 3  #>  Number of SNPs = 14  #>   #> Inflating Parameter: 0.02691197  #>  #>                 Estimate        SD       2.5%        50%     97.5% #> Avg Pleio     -27.966425 11.896242 -51.845794 -27.974842 -3.141311 #> Causal Effect   5.878801  2.277781   1.121291   5.878143 10.460377  #>       5%      95%  #> 2.039501 9.561081"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_stan.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","text":"Bayesian inverse variance weighted model choice prior distributions fitted using RStan","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_stan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","text":"","code":"mr_radialegger_stan(   data,   prior = 1,   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   rho = 0.5,   seed = 12345,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_stan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","text":"data data class mr_format. prior integer selecting prior distributions; 1 selects non-informative set priors; 2 selects weakly informative priors; 3 selects pseudo-horseshoe prior causal effect; 4 selects joint prior intercept causal effect estimate. n.chains Numeric indicating number chains used HMC estimation rstan, default 3 chains. n.burn Numeric indicating burn-period Bayesian HMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian HMC estimation. default 5000 iterations. rho Numeric indicating correlation coefficient input joint prior distribution. default 0.5. seed Numeric indicating random number seed. default 12345. ... Additional arguments passed rstan::sampling().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_stan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","text":"object class rstan::stanfit.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_stan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","text":"Bowden, J., et al., Improving visualization, interpretation analysis two-sample summary data Mendelian randomization via Radial plot Radial regression. International Journal Epidemiology, 2018. 47(4): p. 1264-1278. doi:10.1093/ije/dyy101 . Stan Development Team (2020). \"RStan: R interface Stan.\" R package version 2.19.3, https://mc-stan.org/.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mr_radialegger_stan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian inverse variance weighted model with a choice of prior distributions fitted using RStan. — mr_radialegger_stan","text":"","code":"if (requireNamespace(\"rstan\", quietly = TRUE)) { # Note we recommend setting n.burn and n.iter to larger values suppressWarnings({   radegger_fit <- mr_radialegger_stan(bmi_insulin, n.burn = 500, n.iter = 1000, refresh = 0L) }) print(radegger_fit) } #> Inference for Stan model: mrradialegger. #> 3 chains, each with iter=1000; warmup=500; thin=1;  #> post-warmup draws per chain=500, total post-warmup draws=1500. #>  #>             mean se_mean    sd   2.5%    25%    50%    75%  97.5% n_eff Rhat #> intercept -30.27    0.69 13.02 -55.63 -38.65 -30.91 -21.49  -4.76   360 1.00 #> estimate    6.31    0.13  2.48   1.34   4.67   6.44   7.95  11.14   371 1.00 #> sigma       7.03    0.07  1.29   4.87   6.04   6.91   7.93   9.59   325 1.02 #> lp__      -33.88    0.05  1.10 -36.56 -34.50 -33.67 -33.03 -32.47   425 1.00 #>  #> Samples were drawn using NUTS(diag_e) at Mon Aug 19 14:09:23 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://okezie94.github.io/mrbayes/reference/mrbayes-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mrbayes: Bayesian implementation of the IVW and MR-Egger models for two-sample Mendelian randomization analyses — mrbayes-package","title":"mrbayes: Bayesian implementation of the IVW and MR-Egger models for two-sample Mendelian randomization analyses — mrbayes-package","text":"Bayesian implementation IVW MR-Egger models radial multivariate versions two-sample Mendelian randomization analyses.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mrbayes-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"mrbayes: Bayesian implementation of the IVW and MR-Egger models for two-sample Mendelian randomization analyses — mrbayes-package","text":"Stan Development Team (2019). RStan: R interface Stan. R package version 2.19.2. https://mc-stan.org","code":""},{"path":[]},{"path":"https://okezie94.github.io/mrbayes/reference/mrbayes-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mrbayes: Bayesian implementation of the IVW and MR-Egger models for two-sample Mendelian randomization analyses — mrbayes-package","text":"Maintainer: Tom Palmer remlapmot@hotmail.com (ORCID) Authors: Okezie Uche-Ikonne okezieikonne@gmail.com (ORCID) Frank Dondelinger f.dondelinger@lancaster.ac.uk (ORCID)","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mrinput_mr_format.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an object of class MRInput from the MendelianRandomization package to the mrbayes mr_format class — mrinput_mr_format","title":"Convert an object of class MRInput from the MendelianRandomization package to the mrbayes mr_format class — mrinput_mr_format","text":"Creates data.frame class mr_format object class MRInput generated MendelianRandomization::mr_input.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mrinput_mr_format.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an object of class MRInput from the MendelianRandomization package to the mrbayes mr_format class — mrinput_mr_format","text":"","code":"mrinput_mr_format(dat)"},{"path":"https://okezie94.github.io/mrbayes/reference/mrinput_mr_format.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an object of class MRInput from the MendelianRandomization package to the mrbayes mr_format class — mrinput_mr_format","text":"dat Object MendelianRandomization::mr_input.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mrinput_mr_format.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert an object of class MRInput from the MendelianRandomization package to the mrbayes mr_format class — mrinput_mr_format","text":"Object class mr_format, mrbayes format","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mrinput_mr_format.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an object of class MRInput from the MendelianRandomization package to the mrbayes mr_format class — mrinput_mr_format","text":"","code":"if (requireNamespace(\"MendelianRandomization\", quietly = TRUE)) { dat <- MendelianRandomization::mr_input(   bx = bmi_insulin$beta.exposure,   bxse = bmi_insulin$se.exposure,   by = bmi_insulin$beta.outcome,   byse = bmi_insulin$se.outcome,   snps = bmi_insulin$rsid ) dat <- mrinput_mr_format(dat) head(dat) class(dat) } #> [1] \"data.frame\" \"mr_format\""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_rjags.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","text":"Bayesian implementation MVMR-Egger model choice prior distributions fitted using JAGS.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_rjags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","text":"","code":"mvmr_egger_rjags(   object,   prior = \"default\",   betaprior = \"\",   sigmaprior = \"\",   orientate = 1,   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = NULL,   rho = 0.5,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_rjags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","text":"object data object class mvmr_format. prior character string selecting prior distributions; \"default\" selects non-informative set priors; \"weak\" selects weakly informative priors; \"pseudo\" selects pseudo-horseshoe prior causal effect; betaprior character string JAGS syntax allow user defined prior causal effect. sigmaprior character string JAGS syntax allow user defined prior residual standard deviation. orientate Numeric value indicate oriented exposure n.chains Numeric indicating number chains used MCMC estimation, default 3 chains. n.burn Numeric indicating burn-period Bayesian MCMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default rjags default. rho Numeric indicating correlation coefficient input joint prior distribution. default value 0.5. ... Additional arguments passed rjags::jags.model().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_rjags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","text":"object class mveggerjags containing following components: AvgPleio mean simulated pleiotropic effect CausalEffect mean simulated causal effect StandardError Standard deviation simulated causal effect sigma value residual standard deviation CredibleInterval credible interval causal effect, includes lower (2.5%), median (50%) upper intervals (97.5%) samples Output Bayesian MCMC samples Priors specified priors","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_rjags.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","text":"Bowden et. al., Mendelian randomization invalid instruments: effect estimation bias detection Egger regression. International Journal Epidemiology 2015. 44(2): p. 512-525. doi:10.1093/ije/dyv080","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_rjags.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using JAGS. — mvmr_egger_rjags","text":"","code":"if (requireNamespace(\"rjags\", quietly = TRUE)) { if (FALSE) { # \\dontrun{ dat <- mvmr_format(   rsid = dodata$rsid,   xbeta = cbind(dodata$ldlcbeta,dodata$hdlcbeta,dodata$tgbeta),   ybeta = dodata$chdbeta,   xse = cbind(dodata$ldlcse,dodata$hdlcse,dodata$tgse),   yse = dodata$chdse )  fit <- mvmr_egger_rjags(dat) summary(fit) plot(fit$samples) # 90% credible interval fitdf <- do.call(rbind.data.frame, fit$samples) cri90 <- sapply(fitdf, quantile, probs = c(0.05, 0.95)) print(cri90) } # } }"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_stan.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","text":"Bayesian implementation MVMR-Egger model choice prior distributions fitted using RStan.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_stan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","text":"","code":"mvmr_egger_stan(   data,   prior = 1,   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = 12345,   rho = 0.5,   orientate = 1,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_stan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","text":"data data class mvmr_format. prior integer selecting prior distributions; 1 selects non-informative set priors; 2 selects weakly informative priors; 3 selects pseudo-horseshoe prior causal effect; n.chains Numeric indicating number chains used HMC estimation rstan, default 3 chains. n.burn Numeric indicating burn-period Bayesian HMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian HMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default 12345. rho Numeric indicating correlation coefficient input joint prior distribution. default 0.5. orientate Numeric value indicate oriented exposure. ... Additional arguments passed rstan::sampling().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_stan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","text":"object class rstan::stanfit.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_stan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","text":"Bowden J, Davey Smith G, Burgess S. Mendelian randomization invalid instruments: effect estimation bias detection Egger regression. International Journal Epidemiology, 2015, 44, 2, 512-525. doi:10.1093/ije/dyv080 . Stan Development Team (2020). \"RStan: R interface Stan.\" R package version 2.19.3, https://mc-stan.org/.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_egger_stan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian implementation of the MVMR-Egger model with choice of prior distributions fitted using RStan. — mvmr_egger_stan","text":"","code":"if (requireNamespace(\"rstan\", quietly = TRUE)) { # Note we recommend setting n.burn and n.iter to larger values dat <- mvmr_format(   rsid = dodata$rsid,   xbeta = cbind(dodata$ldlcbeta,dodata$hdlcbeta,dodata$tgbeta),   ybeta = dodata$chdbeta,   xse = cbind(dodata$ldlcse,dodata$hdlcse,dodata$tgse),   yse = dodata$chdse ) suppressWarnings(mvegger_fit <- mvmr_egger_stan(dat, n.burn = 500, n.iter = 1000, refresh = 0L)) print(mvegger_fit) } #> Inference for Stan model: mvmregger. #> 3 chains, each with iter=1000; warmup=500; thin=1;  #> post-warmup draws per chain=500, total post-warmup draws=1500. #>  #>                mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff #> intercept     -0.01    0.00 0.00   -0.01   -0.01   -0.01    0.00    0.00  1287 #> estimate[1]    0.53    0.00 0.07    0.38    0.48    0.52    0.58    0.67   928 #> estimate[2]   -0.10    0.00 0.06   -0.23   -0.14   -0.10   -0.06    0.02   895 #> estimate[3]    0.33    0.00 0.08    0.18    0.28    0.33    0.38    0.48  1009 #> sigma          1.46    0.00 0.08    1.31    1.41    1.46    1.51    1.63   978 #> lp__        -161.84    0.07 1.66 -166.00 -162.80 -161.51 -160.59 -159.63   571 #>             Rhat #> intercept      1 #> estimate[1]    1 #> estimate[2]    1 #> estimate[3]    1 #> sigma          1 #> lp__           1 #>  #> Samples were drawn using NUTS(diag_e) at Mon Aug 19 14:09:25 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_format.html","id":null,"dir":"Reference","previous_headings":"","what":"Organises the summary level data for use in the Bayesian MR functions — mvmr_format","title":"Organises the summary level data for use in the Bayesian MR functions — mvmr_format","text":"Organises summary level data use Bayesian MR functions","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_format.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Organises the summary level data for use in the Bayesian MR functions — mvmr_format","text":"","code":"mvmr_format(rsid, xbeta, ybeta, xse, yse)"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_format.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Organises the summary level data for use in the Bayesian MR functions — mvmr_format","text":"rsid vector genetic variants used analysis, unspecified vector automatically generated. xbeta matrix multiple instrument-phenotypes associations. ybeta numeric vector instrument-outcome associations. xse matrix corresponding standard errors instrument-phenotypes associations xbeta. yse standard errors instrument-outcome associations ybeta.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_format.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Organises the summary level data for use in the Bayesian MR functions — mvmr_format","text":"formatted data frame analysis class mvmr_format.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_format.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Organises the summary level data for use in the Bayesian MR functions — mvmr_format","text":"","code":"data(dodata) dat <- mvmr_format(   rsid = dodata$rsid,   xbeta = cbind(dodata$ldlcbeta,dodata$hdlcbeta,dodata$tgbeta),   ybeta = dodata$chdbeta,   xse = cbind(dodata$ldlcse,dodata$hdlcse,dodata$tgse),   yse = dodata$chdse ) class(dat) #> [1] \"list\"        \"mvmr_format\""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_rjags.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","text":"Bayesian multivariate inverse variance weighted model choice prior distributions fitted using JAGS.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_rjags.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","text":"","code":"mvmr_ivw_rjags(   object,   prior = \"default\",   betaprior = \"\",   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = NULL,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_rjags.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","text":"object data object class mvmr_format. prior character string selecting prior distributions; \"default\" selects non-informative set priors; \"weak\" selects weakly informative priors; \"pseudo\" selects pseudo-horseshoe prior causal effect. betaprior character string JAGS syntax allow user defined prior causal effect. n.chains Numeric indicating number chains used MCMC estimation, default 3 chains. n.burn Numeric indicating burn-period Bayesian MCMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default rjags default. ... Additional arguments passed rjags::jags.model().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_rjags.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","text":"object class mvivwjags containing following components: CausalEffect mean simulated causal effects StandardError Standard deviation simulated causal effects CredibleInterval credible interval causal effect, indicates lower (2.5%), median (50%) upper intervals (97.5%) samples Output Bayesian MCMC samples different chains Priors specified priors","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_rjags.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","text":"Burgess, S., Butterworth, ., Thompson S.G. Mendelian randomization analysis multiple genetic variants using summarized data. Genetic Epidemiology, 2013, 37, 7, 658-665 doi:10.1002/gepi.21758 .","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_rjags.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using JAGS. — mvmr_ivw_rjags","text":"","code":"if (requireNamespace(\"rjags\", quietly = TRUE)) { dat <- mvmr_format(   rsid = dodata$rsid,   xbeta = cbind(dodata$ldlcbeta,dodata$hdlcbeta,dodata$tgbeta),   ybeta = dodata$chdbeta,   xse = cbind(dodata$ldlcse,dodata$hdlcse,dodata$tgse),   yse = dodata$chdse )  fit <- mvmr_ivw_rjags(dat) print(fit) summary(fit) plot(fit$samples) # 90% credible interval fitdf <- do.call(rbind.data.frame, fit$samples) cri90 <- sapply(fitdf, quantile, probs = c(0.05, 0.95)) print(cri90) } #>                  Estimate         SD       2.5%        50%      97.5% #> Causal Effect1  0.4235412 0.03836709  0.3484561  0.4233091  0.4985763 #> Causal Effect2 -0.1171498 0.04195474 -0.2000855 -0.1170895 -0.0361604 #> Causal Effect3  0.2807476 0.05077301  0.1814942  0.2805495  0.3809082 #> Prior :  #>  #>  for (j in 1:K) { #>   Estimate[j] ~ dnorm(0,1E-3) #>   }  #>  #> Estimation results:  #>   #>  MCMC iterations = 6000  #>  Burn in = 1000  #>  Sample size by chain = 5000  #>  Number of Chains = 3  #>  Number of SNPs = 185  #>   #>                  Estimate         SD       2.5%        50%      97.5% #> Causal Effect1  0.4235412 0.03836709  0.3484561  0.4233091  0.4985763 #> Causal Effect2 -0.1171498 0.04195474 -0.2000855 -0.1170895 -0.0361604 #> Causal Effect3  0.2807476 0.05077301  0.1814942  0.2805495  0.3809082  #>     Estimate[1] Estimate[2] Estimate[3] #> 5%    0.3604705 -0.18676371   0.1967331 #> 95%   0.4874204 -0.04946738   0.3641892"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_stan.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","text":"Bayesian multivariate inverse variance weighted model choice prior distributions fitted using RStan.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_stan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","text":"","code":"mvmr_ivw_stan(   data,   prior = 1,   n.chains = 3,   n.burn = 1000,   n.iter = 5000,   seed = 12345,   ... )"},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_stan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","text":"data data class mvmr_format. prior integer selecting prior distributions; 1 selects non-informative set priors; 2 selects weakly informative priors; 3 selects pseudo-horseshoe prior causal effect. n.chains Numeric indicating number chains used HMC estimation rstan, default 3 chains. n.burn Numeric indicating burn-period Bayesian HMC estimation. default 1000 samples. n.iter Numeric indicating number iterations Bayesian MCMC estimation. default 5000 iterations. seed Numeric indicating random number seed. default 12345. ... Additional arguments passed rstan::sampling().","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_stan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","text":"object class rstan::stanfit.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_stan.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","text":"Burgess, S., Butterworth, ., Thompson S.G. Mendelian randomization analysis multiple genetic variants using summarized data. Genetic Epidemiology, 2013, 37, 7, 658-665 doi:10.1002/gepi.21758 . Stan Development Team (2020). \"RStan: R interface Stan.\" R package version 2.19.3, https://mc-stan.org/.","code":""},{"path":"https://okezie94.github.io/mrbayes/reference/mvmr_ivw_stan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian multivariate inverse variance weighted model with a choice of prior distributions fitted using RStan. — mvmr_ivw_stan","text":"","code":"if (requireNamespace(\"rstan\", quietly = TRUE)) { dat <- mvmr_format(   rsid = dodata$rsid,   xbeta = cbind(dodata$ldlcbeta,dodata$hdlcbeta,dodata$tgbeta),   ybeta = dodata$chdbeta,   xse = cbind(dodata$ldlcse,dodata$hdlcse,dodata$tgse),   yse = dodata$chdse ) suppressWarnings(mvivw_fit <- mvmr_ivw_stan(dat, refresh = 0L)) print(mvivw_fit) rstan::traceplot(mvivw_fit) } #> Inference for Stan model: mvmrivw. #> 3 chains, each with iter=5000; warmup=1000; thin=1;  #> post-warmup draws per chain=4000, total post-warmup draws=12000. #>  #>                mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff #> estimate[1]    0.42    0.00 0.04    0.35    0.40    0.42    0.45    0.50  6505 #> estimate[2]   -0.12    0.00 0.04   -0.20   -0.15   -0.12   -0.09   -0.04  6596 #> estimate[3]    0.28    0.00 0.05    0.18    0.25    0.28    0.31    0.38  6174 #> lp__        -198.11    0.02 1.23 -201.39 -198.66 -197.78 -197.21 -196.73  4664 #>             Rhat #> estimate[1]    1 #> estimate[2]    1 #> estimate[3]    1 #> lp__           1 #>  #> Samples were drawn using NUTS(diag_e) at Mon Aug 19 14:09:26 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1)."},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-052","dir":"Changelog","previous_headings":"","what":"mrbayes 0.5.2","title":"mrbayes 0.5.2","text":"CRAN release: 2024-08-19 NAMESPACE now imports fewer functions packages. number dependency packages reduced. Added CITATION file. datasets now compressed. Maintainer switched TP.","code":""},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-051","dir":"Changelog","previous_headings":"","what":"mrbayes 0.5.1","title":"mrbayes 0.5.1","text":"CRAN release: 2021-10-02 mvmr_egger_rjags() helpfile example now run rjags package installed.","code":""},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-050","dir":"Changelog","previous_headings":"","what":"mrbayes 0.5.0","title":"mrbayes 0.5.0","text":"CRAN release: 2021-09-21 examples helpfiles functions testthat test files now check whether relevant Bayesian software package installed (.e. rstan rjags). JAGS compile aarch64 (Apple M1 processor) architecture.","code":""},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-040","dir":"Changelog","previous_headings":"","what":"mrbayes 0.4.0","title":"mrbayes 0.4.0","text":"CRAN release: 2021-07-13 Additional checks installation JAGS.","code":""},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-030","dir":"Changelog","previous_headings":"","what":"mrbayes 0.3.0","title":"mrbayes 0.3.0","text":"CRAN release: 2021-04-01 Additional functions multivariate IVW MR-Egger using JAGS rstan","code":""},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-020","dir":"Changelog","previous_headings":"","what":"mrbayes 0.2.0","title":"mrbayes 0.2.0","text":"CRAN release: 2020-05-28 IVW implemented using rstan. MR-Egger implemented using rstan. Radial MR-Egger implemented using rstan.","code":""},{"path":"https://okezie94.github.io/mrbayes/news/index.html","id":"mrbayes-010","dir":"Changelog","previous_headings":"","what":"mrbayes 0.1.0","title":"mrbayes 0.1.0","text":"CRAN release: 2019-09-04 IVW, MR-Egger, radial versions implemented using JAGS.","code":""}]
